{"version":3,"file":"holoplaycore.module-09fbf441.js","sources":["../../src/matrix/lib/holoplaycore.module.js"],"sourcesContent":["var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar cbor = createCommonjsModule(function (module) {\n/*\n * The MIT License (MIT)\n *\n * Copyright (c) 2014 Patrick Gansterer <paroga@paroga.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n(function(global, undefined$1) {var POW_2_24 = Math.pow(2, -24),\n    POW_2_32 = Math.pow(2, 32),\n    POW_2_53 = Math.pow(2, 53);\n\nfunction encode(value) {\n  var data = new ArrayBuffer(256);\n  var dataView = new DataView(data);\n  var lastLength;\n  var offset = 0;\n\n  function ensureSpace(length) {\n    var newByteLength = data.byteLength;\n    var requiredLength = offset + length;\n    while (newByteLength < requiredLength)\n      newByteLength *= 2;\n    if (newByteLength !== data.byteLength) {\n      var oldDataView = dataView;\n      data = new ArrayBuffer(newByteLength);\n      dataView = new DataView(data);\n      var uint32count = (offset + 3) >> 2;\n      for (var i = 0; i < uint32count; ++i)\n        dataView.setUint32(i * 4, oldDataView.getUint32(i * 4));\n    }\n\n    lastLength = length;\n    return dataView;\n  }\n  function write() {\n    offset += lastLength;\n  }\n  function writeFloat64(value) {\n    write(ensureSpace(8).setFloat64(offset, value));\n  }\n  function writeUint8(value) {\n    write(ensureSpace(1).setUint8(offset, value));\n  }\n  function writeUint8Array(value) {\n    var dataView = ensureSpace(value.length);\n    for (var i = 0; i < value.length; ++i)\n      dataView.setUint8(offset + i, value[i]);\n    write();\n  }\n  function writeUint16(value) {\n    write(ensureSpace(2).setUint16(offset, value));\n  }\n  function writeUint32(value) {\n    write(ensureSpace(4).setUint32(offset, value));\n  }\n  function writeUint64(value) {\n    var low = value % POW_2_32;\n    var high = (value - low) / POW_2_32;\n    var dataView = ensureSpace(8);\n    dataView.setUint32(offset, high);\n    dataView.setUint32(offset + 4, low);\n    write();\n  }\n  function writeTypeAndLength(type, length) {\n    if (length < 24) {\n      writeUint8(type << 5 | length);\n    } else if (length < 0x100) {\n      writeUint8(type << 5 | 24);\n      writeUint8(length);\n    } else if (length < 0x10000) {\n      writeUint8(type << 5 | 25);\n      writeUint16(length);\n    } else if (length < 0x100000000) {\n      writeUint8(type << 5 | 26);\n      writeUint32(length);\n    } else {\n      writeUint8(type << 5 | 27);\n      writeUint64(length);\n    }\n  }\n  \n  function encodeItem(value) {\n    var i;\n\n    if (value === false)\n      return writeUint8(0xf4);\n    if (value === true)\n      return writeUint8(0xf5);\n    if (value === null)\n      return writeUint8(0xf6);\n    if (value === undefined$1)\n      return writeUint8(0xf7);\n  \n    switch (typeof value) {\n      case \"number\":\n        if (Math.floor(value) === value) {\n          if (0 <= value && value <= POW_2_53)\n            return writeTypeAndLength(0, value);\n          if (-POW_2_53 <= value && value < 0)\n            return writeTypeAndLength(1, -(value + 1));\n        }\n        writeUint8(0xfb);\n        return writeFloat64(value);\n\n      case \"string\":\n        var utf8data = [];\n        for (i = 0; i < value.length; ++i) {\n          var charCode = value.charCodeAt(i);\n          if (charCode < 0x80) {\n            utf8data.push(charCode);\n          } else if (charCode < 0x800) {\n            utf8data.push(0xc0 | charCode >> 6);\n            utf8data.push(0x80 | charCode & 0x3f);\n          } else if (charCode < 0xd800) {\n            utf8data.push(0xe0 | charCode >> 12);\n            utf8data.push(0x80 | (charCode >> 6)  & 0x3f);\n            utf8data.push(0x80 | charCode & 0x3f);\n          } else {\n            charCode = (charCode & 0x3ff) << 10;\n            charCode |= value.charCodeAt(++i) & 0x3ff;\n            charCode += 0x10000;\n\n            utf8data.push(0xf0 | charCode >> 18);\n            utf8data.push(0x80 | (charCode >> 12)  & 0x3f);\n            utf8data.push(0x80 | (charCode >> 6)  & 0x3f);\n            utf8data.push(0x80 | charCode & 0x3f);\n          }\n        }\n\n        writeTypeAndLength(3, utf8data.length);\n        return writeUint8Array(utf8data);\n\n      default:\n        var length;\n        if (Array.isArray(value)) {\n          length = value.length;\n          writeTypeAndLength(4, length);\n          for (i = 0; i < length; ++i)\n            encodeItem(value[i]);\n        } else if (value instanceof Uint8Array) {\n          writeTypeAndLength(2, value.length);\n          writeUint8Array(value);\n        } else {\n          var keys = Object.keys(value);\n          length = keys.length;\n          writeTypeAndLength(5, length);\n          for (i = 0; i < length; ++i) {\n            var key = keys[i];\n            encodeItem(key);\n            encodeItem(value[key]);\n          }\n        }\n    }\n  }\n  \n  encodeItem(value);\n\n  if (\"slice\" in data)\n    return data.slice(0, offset);\n  \n  var ret = new ArrayBuffer(offset);\n  var retView = new DataView(ret);\n  for (var i = 0; i < offset; ++i)\n    retView.setUint8(i, dataView.getUint8(i));\n  return ret;\n}\n\nfunction decode(data, tagger, simpleValue) {\n  var dataView = new DataView(data);\n  var offset = 0;\n  \n  if (typeof tagger !== \"function\")\n    tagger = function(value) { return value; };\n  if (typeof simpleValue !== \"function\")\n    simpleValue = function() { return undefined$1; };\n\n  function read(value, length) {\n    offset += length;\n    return value;\n  }\n  function readArrayBuffer(length) {\n    return read(new Uint8Array(data, offset, length), length);\n  }\n  function readFloat16() {\n    var tempArrayBuffer = new ArrayBuffer(4);\n    var tempDataView = new DataView(tempArrayBuffer);\n    var value = readUint16();\n\n    var sign = value & 0x8000;\n    var exponent = value & 0x7c00;\n    var fraction = value & 0x03ff;\n    \n    if (exponent === 0x7c00)\n      exponent = 0xff << 10;\n    else if (exponent !== 0)\n      exponent += (127 - 15) << 10;\n    else if (fraction !== 0)\n      return fraction * POW_2_24;\n    \n    tempDataView.setUint32(0, sign << 16 | exponent << 13 | fraction << 13);\n    return tempDataView.getFloat32(0);\n  }\n  function readFloat32() {\n    return read(dataView.getFloat32(offset), 4);\n  }\n  function readFloat64() {\n    return read(dataView.getFloat64(offset), 8);\n  }\n  function readUint8() {\n    return read(dataView.getUint8(offset), 1);\n  }\n  function readUint16() {\n    return read(dataView.getUint16(offset), 2);\n  }\n  function readUint32() {\n    return read(dataView.getUint32(offset), 4);\n  }\n  function readUint64() {\n    return readUint32() * POW_2_32 + readUint32();\n  }\n  function readBreak() {\n    if (dataView.getUint8(offset) !== 0xff)\n      return false;\n    offset += 1;\n    return true;\n  }\n  function readLength(additionalInformation) {\n    if (additionalInformation < 24)\n      return additionalInformation;\n    if (additionalInformation === 24)\n      return readUint8();\n    if (additionalInformation === 25)\n      return readUint16();\n    if (additionalInformation === 26)\n      return readUint32();\n    if (additionalInformation === 27)\n      return readUint64();\n    if (additionalInformation === 31)\n      return -1;\n    throw \"Invalid length encoding\";\n  }\n  function readIndefiniteStringLength(majorType) {\n    var initialByte = readUint8();\n    if (initialByte === 0xff)\n      return -1;\n    var length = readLength(initialByte & 0x1f);\n    if (length < 0 || (initialByte >> 5) !== majorType)\n      throw \"Invalid indefinite length element\";\n    return length;\n  }\n\n  function appendUtf16data(utf16data, length) {\n    for (var i = 0; i < length; ++i) {\n      var value = readUint8();\n      if (value & 0x80) {\n        if (value < 0xe0) {\n          value = (value & 0x1f) <<  6\n                | (readUint8() & 0x3f);\n          length -= 1;\n        } else if (value < 0xf0) {\n          value = (value & 0x0f) << 12\n                | (readUint8() & 0x3f) << 6\n                | (readUint8() & 0x3f);\n          length -= 2;\n        } else {\n          value = (value & 0x0f) << 18\n                | (readUint8() & 0x3f) << 12\n                | (readUint8() & 0x3f) << 6\n                | (readUint8() & 0x3f);\n          length -= 3;\n        }\n      }\n\n      if (value < 0x10000) {\n        utf16data.push(value);\n      } else {\n        value -= 0x10000;\n        utf16data.push(0xd800 | (value >> 10));\n        utf16data.push(0xdc00 | (value & 0x3ff));\n      }\n    }\n  }\n\n  function decodeItem() {\n    var initialByte = readUint8();\n    var majorType = initialByte >> 5;\n    var additionalInformation = initialByte & 0x1f;\n    var i;\n    var length;\n\n    if (majorType === 7) {\n      switch (additionalInformation) {\n        case 25:\n          return readFloat16();\n        case 26:\n          return readFloat32();\n        case 27:\n          return readFloat64();\n      }\n    }\n\n    length = readLength(additionalInformation);\n    if (length < 0 && (majorType < 2 || 6 < majorType))\n      throw \"Invalid length\";\n\n    switch (majorType) {\n      case 0:\n        return length;\n      case 1:\n        return -1 - length;\n      case 2:\n        if (length < 0) {\n          var elements = [];\n          var fullArrayLength = 0;\n          while ((length = readIndefiniteStringLength(majorType)) >= 0) {\n            fullArrayLength += length;\n            elements.push(readArrayBuffer(length));\n          }\n          var fullArray = new Uint8Array(fullArrayLength);\n          var fullArrayOffset = 0;\n          for (i = 0; i < elements.length; ++i) {\n            fullArray.set(elements[i], fullArrayOffset);\n            fullArrayOffset += elements[i].length;\n          }\n          return fullArray;\n        }\n        return readArrayBuffer(length);\n      case 3:\n        var utf16data = [];\n        if (length < 0) {\n          while ((length = readIndefiniteStringLength(majorType)) >= 0)\n            appendUtf16data(utf16data, length);\n        } else\n          appendUtf16data(utf16data, length);\n        return String.fromCharCode.apply(null, utf16data);\n      case 4:\n        var retArray;\n        if (length < 0) {\n          retArray = [];\n          while (!readBreak())\n            retArray.push(decodeItem());\n        } else {\n          retArray = new Array(length);\n          for (i = 0; i < length; ++i)\n            retArray[i] = decodeItem();\n        }\n        return retArray;\n      case 5:\n        var retObject = {};\n        for (i = 0; i < length || length < 0 && !readBreak(); ++i) {\n          var key = decodeItem();\n          retObject[key] = decodeItem();\n        }\n        return retObject;\n      case 6:\n        return tagger(decodeItem(), length);\n      case 7:\n        switch (length) {\n          case 20:\n            return false;\n          case 21:\n            return true;\n          case 22:\n            return null;\n          case 23:\n            return undefined$1;\n          default:\n            return simpleValue(length);\n        }\n    }\n  }\n\n  var ret = decodeItem();\n  if (offset !== data.byteLength)\n    throw \"Remaining bytes\";\n  return ret;\n}\n\nvar obj = { encode: encode, decode: decode };\n\nif (typeof undefined$1 === \"function\" && undefined$1.amd)\n  undefined$1(\"cbor/cbor\", obj);\nelse if ( module.exports)\n  module.exports = obj;\nelse if (!global.CBOR)\n  global.CBOR = obj;\n\n})(commonjsGlobal);\n});\n\n/**\n * This files defines the HoloPlayClient class and Message class.\n *\n * Copyright (c) [2019] [Looking Glass Factory]\n *\n * @link    https://lookingglassfactory.com/\n * @file    This files defines the HoloPlayClient class and Message class.\n * @author  Looking Glass Factory.\n * @version 0.0.8\n * @license SEE LICENSE IN LICENSE.md\n */\n\n// Polyfill WebSocket for nodejs applications.\nconst WebSocket =\n    typeof window === 'undefined' ? require('ws') : window.WebSocket;\n\n/** Class representing a client to communicates with the HoloPlayService. */\nclass Client {\n  /**\n   * Establish a client to talk to HoloPlayService.\n   * @constructor\n   * @param {function} initCallback - optional; a function to trigger when\n   *     response is received\n   * @param {function} errCallback - optional; a function to trigger when there\n   *     is a connection error\n   * @param {function} closeCallback - optional; a function to trigger when the\n   *     socket is closed\n   * @param {boolean} debug - optional; default is false\n   * @param {string}  appId - optional\n   * @param {boolean} isGreedy - optional\n   * @param {string}  oncloseBehavior - optional, can be 'wipe', 'hide', 'none'\n   */\n  constructor(\n      initCallback, errCallback, closeCallback, debug = false, appId, isGreedy,\n      oncloseBehavior) {\n    this.reqs = [];\n    this.reps = [];\n    this.requestId = this.getRequestId();\n    this.debug = debug;\n    this.isGreedy = isGreedy;\n    this.errCallback = errCallback;\n    this.closeCallback = closeCallback;\n    this.alwaysdebug = false;\n    this.isConnected = false;\n    let initCmd = null;\n    if (appId || isGreedy || oncloseBehavior) {\n      initCmd = new InitMessage(appId, isGreedy, oncloseBehavior, this.debug);\n    } else {\n      if (debug) this.alwaysdebug = true;\n      if (typeof initCallback == 'function') initCmd = new InfoMessage();\n    }\n    this.openWebsocket(initCmd, initCallback);\n  }\n  /**\n   * Send a message over the websocket to HoloPlayService.\n   * @public\n   * @param {Message} msg - message object\n   * @param {integer} timeoutSecs - optional, default is 60 seconds\n   */\n  sendMessage(msg, timeoutSecs = 60) {\n    if (this.alwaysdebug) msg.cmd.debug = true;\n    let cborData = msg.toCbor();\n    return this.sendRequestObj(cborData, timeoutSecs);\n  }\n  /**\n   * Disconnects from the web socket.\n   * @public\n   */\n  disconnect() {\n    this.ws.close();\n  }\n  /**\n   * Open a websocket and set handlers\n   * @private\n   */\n  openWebsocket(firstCmd = null, initCallback = null) {\n    this.ws =\n        new WebSocket('ws://localhost:11222/driver', ['rep.sp.nanomsg.org']);\n    this.ws.parent = this;\n    this.ws.binaryType = 'arraybuffer';\n    this.ws.onmessage = this.messageHandler;\n    this.ws.onopen = (() => {\n      this.isConnected = true;\n      if (this.debug) {\n        console.log('socket open');\n      }\n      if (firstCmd != null) {\n        this.sendMessage(firstCmd).then(initCallback);\n      }\n    });\n    this.ws.onerror = this.onSocketError;\n    this.ws.onclose = this.onClose;\n  }\n  /**\n   * Send a request object over websocket\n   * @private\n   */\n  sendRequestObj(data, timeoutSecs) {\n    return new Promise((resolve, reject) => {\n      let reqObj = {\n        id: this.requestId++,\n        parent: this,\n        payload: data,\n        success: resolve,\n        error: reject,\n        send: function() {\n          if (this.debug)\n            console.log('attemtping to send request with ID ' + this.id);\n          this.timeout = setTimeout(reqObj.send.bind(this), timeoutSecs * 1000);\n          let tmp = new Uint8Array(data.byteLength + 4);\n          let view = new DataView(tmp.buffer);\n          view.setUint32(0, this.id);\n          tmp.set(new Uint8Array(this.payload), 4);\n          this.parent.ws.send(tmp.buffer);\n        }\n      };\n      this.reqs.push(reqObj);\n      reqObj.send();\n    });\n  }\n  /**\n   * Handles a message when received\n   * @private\n   */\n  messageHandler(event) {\n    console.log('message');\n    let data = event.data;\n    if (data.byteLength < 4) return;\n    let view = new DataView(data);\n    let replyId = view.getUint32(0);\n    if (replyId < 0x80000000) {\n      this.parent.err('bad nng header');\n      return;\n    }\n    let i = this.parent.findReqIndex(replyId);\n    if (i == -1) {\n      this.parent.err('got reply that doesn\\'t match known request!');\n      return;\n    }\n    let rep = {id: replyId, payload: cbor.decode(data.slice(4))};\n    if (rep.payload.error == 0) {\n      this.parent.reqs[i].success(rep.payload);\n    } else {\n      this.parent.reqs[i].error(rep.payload);\n    }\n    clearTimeout(this.parent.reqs[i].timeout);\n    this.parent.reqs.splice(i, 1);\n    this.parent.reps.push(rep);\n    if (this.debug) {\n      console.log(rep.payload);\n    }\n  }\n  getRequestId() {\n    return Math.floor(this.prng() * (0x7fffffff)) + 0x80000000;\n  }\n  onClose(event) {\n    this.parent.isConnected = false;\n    if (this.parent.debug) {\n      console.log('socket closed');\n    }\n    if (typeof this.parent.closeCallback == 'function')\n      this.parent.closeCallback(event);\n  }\n  onSocketError(error) {\n    if (this.parent.debug) {\n      console.log(error);\n    }\n    if (typeof this.parent.errCallback == 'function') {\n      this.parent.errCallback(error);\n    }\n  }\n  err(errorMsg) {\n    if (this.debug) {\n      console.log('[DRIVER ERROR]' + errorMsg);\n    }\n    // TODO : make this return an event obj rather than a string\n    // if (typeof this.errCallback == 'function')\n    //   this.errCallback(errorMsg);\n  }\n  findReqIndex(replyId) {\n    let i = 0;\n    for (; i < this.reqs.length; i++) {\n      if (this.reqs[i].id == replyId) {\n        return i;\n      }\n    }\n    return -1;\n  }\n  prng() {\n    if (this.rng == undefined) {\n      this.rng = generateRng();\n    }\n    return this.rng();\n  }\n}\n\n/** A class to represent messages being sent over to HoloPlay Service */\nclass Message {\n  /**\n   * Construct a barebone message.\n   * @constructor\n   */\n  constructor(cmd, bin) {\n    this.cmd = cmd;\n    this.bin = bin;\n  }\n  /**\n   * Convert the class instance to the CBOR format\n   * @public\n   * @returns {CBOR} - cbor object of the message\n   */\n  toCbor() {\n    return cbor.encode(this);\n  }\n}\n/** Message to init. Extends the base Message class. */\nclass InitMessage extends Message {\n  /**\n   * @constructor\n   * @param {string}  appId - a unique id for app\n   * @param {boolean} isGreedy - will it take over screen\n   * @param {string}  oncloseBehavior - can be 'wipe', 'hide', 'none'\n   */\n  constructor(appId = '', isGreedy = false, onclose = '', debug = false) {\n    let cmd = {'init': {}};\n    if (appId != '') cmd['init'].appid = appId;\n    if (onclose != '') cmd['init'].onclose = onclose;\n    if (isGreedy) cmd['init'].greedy = true;\n    if (debug) cmd['init'].debug = true;\n    super(cmd, null);\n  }\n}\n/** Delete a quilt from HoloPlayService. Extends the base Message class. */\nclass DeleteMessage extends Message {\n  /**\n   * @constructor\n   * @param {string} name - name of the quilt\n   */\n  constructor(name = '') {\n    let cmd = {'delete': {'name': name}};\n    super(cmd, null);\n  }\n}\n/** Check if a quilt exist in cache. Extends the base Message class. */\nclass CheckMessage extends Message {\n  /**\n   * @constructor\n   * @param {string} name - name of the quilt\n   */\n  constructor(name = '') {\n    let cmd = {'check': {'name': name}};\n    super(cmd, null);\n  }\n}\n/** Wipes the image in Looking Glass and displays the background image */\nclass WipeMessage extends Message {\n  /**\n   * @constructor\n   * @param {number} targetDisplay - optional, if not provided, default is 0\n   */\n  constructor(targetDisplay = null) {\n    let cmd = {'wipe': {}};\n    if (targetDisplay != null) cmd['wipe'].targetDisplay = targetDisplay;\n    super(cmd, null);\n  }\n}\n/** Get info from the HoloPlayService */\nclass InfoMessage extends Message {\n  /**\n   * @constructor\n   */\n  constructor() {\n    let cmd = {'info': {}};\n    super(cmd, null);\n  }\n}\n/** Get shader uniforms from HoloPlayService */\nclass UniformsMessage extends Message {\n  /**\n   * @constructor\n   * @param {object}\n   */\n  constructor() {\n    let cmd = {'uniforms': {}};\n    super(cmd, bindata);\n  }\n}\n/** Get GLSL shader code from HoloPlayService */\nclass ShaderMessage extends Message {\n  /**\n   * @constructor\n   * @param {object}\n   */\n  constructor() {\n    let cmd = {'shader': {}};\n    super(cmd, bindata);\n  }\n}\n/** Show a quilt in the Looking Glass with the binary data of quilt provided */\nclass ShowMessage extends Message {\n  /**\n   * @constructor\n   * @param {object}\n   */\n  constructor(\n      settings = {vx: 5, vy: 9, aspect: 1.6}, bindata = '',\n      targetDisplay = null) {\n    let cmd = {\n      'show': {\n        'source': 'bindata',\n        'quilt': {'type': 'image', 'settings': settings}\n      }\n    };\n    if (targetDisplay != null) cmd['show']['targetDisplay'] = targetDisplay;\n    super(cmd, bindata);\n  }\n}\n/** extends the base Message class */\nclass CacheMessage extends Message {\n  constructor(\n      name, settings = {vx: 5, vy: 9, aspect: 1.6}, bindata = '',\n      show = false) {\n    let cmd = {\n      'cache': {\n        'show': show,\n        'quilt': {\n          'name': name,\n          'type': 'image',\n          'settings': settings,\n        }\n      }\n    };\n    super(cmd, bindata);\n  }\n}\n\nclass ShowCachedMessage extends Message {\n  constructor(name, targetDisplay = null, settings = null) {\n    let cmd = {'show': {'source': 'cache', 'quilt': {'name': name}}};\n    if (targetDisplay != null) cmd['show']['targetDisplay'] = targetDisplay;\n    if (settings != null) cmd['show']['quilt'].settings = settings;\n    super(cmd, null);\n  }\n}\n/* helper function */\nfunction generateRng() {\n  function xmur3(str) {\n    for (var i = 0, h = 1779033703 ^ str.length; i < str.length; i++)\n      h = Math.imul(h ^ str.charCodeAt(i), 3432918353), h = h << 13 | h >>> 19;\n    return function() {\n      h = Math.imul(h ^ h >>> 16, 2246822507);\n      h = Math.imul(h ^ h >>> 13, 3266489909);\n      return (h ^= h >>> 16) >>> 0;\n    }\n  }\n  function xoshiro128ss(a, b, c, d) {\n    return (() => {\n      var t = b << 9, r = a * 5;\n      r = (r << 7 | r >>> 25) * 9;\n      c ^= a;\n      d ^= b;\n      b ^= c;\n      a ^= d;\n      c ^= t;\n      d = d << 11 | d >>> 21;\n      return (r >>> 0) / 4294967296;\n    })\n  }  var state = Date.now();\n  var seed = xmur3(state.toString());\n  return xoshiro128ss(seed(), seed(), seed(), seed());\n}\n\nexport { CacheMessage, CheckMessage, Client, DeleteMessage, InfoMessage, InitMessage, Message, ShaderMessage, ShowCachedMessage, ShowMessage, UniformsMessage, WipeMessage };\n"],"names":["commonjsGlobal","createCommonjsModule","fn","module","cbor","global","undefined$1","POW_2_24","POW_2_32","POW_2_53","encode","value","data","dataView","lastLength","offset","ensureSpace","length","newByteLength","requiredLength","oldDataView","uint32count","write","writeFloat64","writeUint8","writeUint8Array","i","writeUint16","writeUint32","writeUint64","low","high","writeTypeAndLength","type","encodeItem","utf8data","charCode","keys","key","ret","retView","decode","tagger","simpleValue","read","readArrayBuffer","readFloat16","tempArrayBuffer","tempDataView","readUint16","sign","exponent","fraction","readFloat32","readFloat64","readUint8","readUint32","readUint64","readBreak","readLength","additionalInformation","readIndefiniteStringLength","majorType","initialByte","appendUtf16data","utf16data","decodeItem","elements","fullArrayLength","fullArray","fullArrayOffset","retArray","retObject","obj","WebSocket","Client","initCallback","errCallback","closeCallback","debug","appId","isGreedy","oncloseBehavior","initCmd","InitMessage","InfoMessage","msg","timeoutSecs","cborData","firstCmd","resolve","reject","reqObj","tmp","event","replyId","rep","error","errorMsg","generateRng","Message","cmd","bin","onclose","DeleteMessage","name","CheckMessage","WipeMessage","targetDisplay","UniformsMessage","ShaderMessage","ShowMessage","settings","bindata","CacheMessage","show","ShowCachedMessage","xmur3","str","h","xoshiro128ss","b","c","d","t","r","state","seed"],"mappings":"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"}